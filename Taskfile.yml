version: '3'
includes:
  resource-service:
    taskfile: ./resource-service/Taskfile.yml
  search-service:
    taskfile: ./search-service/Taskfile.yml
  front:
    taskfile: ./front/Taskfile.yml
tasks:
  run-debug:
    cmds:
      - docker compose -f docker-compose.yml -f docker-compose.debug.yml -f search-service/deploy/docker-compose.debug.yml -f resource-service/deploy/docker-compose.debug.yml -f front/deploy/docker-compose.debug.yml up --build -d
    silent: true
  run-prod:
    cmds:
      - docker compose -f docker-compose.yml up --build -d
    silent: true
  recreate-frontend:
    cmds:
      - docker compose up --force-recreate --no-deps front -d --build
    silent: true
  run-frontend-local:
    cmds:
      - cd front && npm run dev
  run-frontend-debug:
    cmds:
      - docker compose -f docker-compose.yml -f docker-compose.debug.yml -f front/deploy/docker-compose.debug.yml up --build front -d
    silent: true
  run-search-debug:
    cmds:
      - docker compose -f docker-compose.yml -f docker-compose.debug.yml -f search-service/deploy/docker-compose.debug.yml up --build search-service -d
    silent: true
  run-resource-debug:
    cmds:
      - docker compose -f docker-compose.yml -f docker-compose.debug.yml -f resource-service/deploy/docker-compose.debug.yml up --build resource-service -d
    silent: true
  down-all-delete-search_db:
    cmds:
      - docker compose down
      - rm -r ./search_database/.data
  down-all:
    cmd: docker compose down